<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>巡回リスト Index</title>
<style>
  :root { --bg:#f5f6f8; --panel:#ffffff; --border:#e5e7eb; --text:#111827; --muted:#6b7280; --accent:#2563eb; --pink:#ffc0cb; --stopped:#9ca3af; --skip:#fff3b0; }
  * { box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
  body { margin:0; background:var(--bg); color:var(--text); font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans JP","Hiragino Kaku Gothic ProN",Meiryo,sans-serif; }
  header { position:sticky; top:0; background:#ffffffcc; backdrop-filter:saturate(180%) blur(8px); border-bottom:1px solid var(--border); padding:14px 16px; }
  h1 { margin:0; font-size:18px; text-align:center; color:var(--accent); letter-spacing:.02em; }
  main { padding:16px; }
  .card { display:flex; align-items:center; justify-content:space-between; background:var(--panel); border:1px solid var(--border); border-radius:14px; padding:14px 16px; margin-bottom:12px; }
  .name a { color:var(--text); text-decoration:none; font-weight:600; }
  .meta { color:var(--muted); font-variant-numeric:tabular-nums; }
  .all { background:linear-gradient(180deg,#fff,#f7f8fb); }
  .note { color:var(--muted); font-size:12px; text-align:center; padding:6px 0 12px; }
  a { color:var(--accent); text-decoration:none; }
</style>
</head>
<body>
  <header><h1>巡回リスト</h1></header>
  <main>
    <div class="card">
      <div class="name"><a href="yamato.html">大和市</a></div>
      <div class="meta" id="yamato_count">0/0 (0%)</div>
    </div>
    <div class="card">
      <div class="name"><a href="ebina.html">海老名市</a></div>
      <div class="meta" id="ebina_count">0/0 (0%)</div>
    </div>
    <div class="card">
      <div class="name"><a href="chofu.html">調布市</a></div>
      <div class="meta" id="chofu_count">0/0 (0%)</div>
    </div>
    <div class="card all">
      <div class="name">全エリア達成度</div>
      <div class="meta" id="all_count">0/0 (0%)</div>
    </div>
    <div class="note">チェック状態は端末内（localStorage）に保存されます。停止・不要の状態はページごとに管理されます。</div>
  </main>
<script>
  const cities = ["yamato","ebina","chofu"];
  function getState(city){
    try{
      const s = JSON.parse(localStorage.getItem("junkai_"+city));
      if (!s) return {items:[],checked:[],flags:[]};
      return {items:Array.isArray(s.items)?s.items:[],checked:Array.isArray(s.checked)?s.checked:[],flags:Array.isArray(s.flags)?s.flags:[]};
    }catch(e){ return {items:[],checked:[],flags:[]}; }
  }
  function updateCounts(){
    let totalAll=0, doneAll=0;
    for(const c of cities){
      const s=getState(c);
      const total=s.items.length;
      const done=s.checked.filter(Boolean).length;
      totalAll+=total; doneAll+=done;
      const pct= total? Math.round(done/total*100):0;
      const el=document.getElementById(c+"_count");
      if(el) el.textContent = `${done}/${total} (${pct}%)`;
    }
    const pctAll = totalAll? Math.round(doneAll/totalAll*100):0;
    document.getElementById("all_count").textContent = `${doneAll}/${totalAll} (${pctAll}%)`;
  }
  updateCounts();
</script>
</body>
</html>
