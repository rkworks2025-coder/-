<!doctype html>
<html lang="ja">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>調布市 巡回</title>

<style>
  :root{ --bg:#f6f7fb; --surface:#fff; --border:#e6e8ee; --text:#111; --muted:#6b7280; --accent:#111; --checked:#ffe8ef; }
  *{box-sizing:border-box}
  html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
  header{position:sticky;top:0;background:var(--surface);padding:12px 16px;border-bottom:1px solid var(--border);z-index:10;display:flex;gap:8px;align-items:center}
  header .back{text-decoration:none;border:1px solid var(--border);padding:8px 12px;border-radius:12px;color:var(--text)}
  header h1{margin:0;font-size:18px;flex:1;text-align:center}
  header .count{font-weight:700;color:var(--muted);font-variant-numeric:tabular-nums}
  main{padding:12px 12px 24px;max-width:820px;margin:0 auto}
  .toolbar{display:flex;gap:8px;margin-bottom:8px;flex-wrap:wrap;justify-content:center}
  .pill{padding:8px 12px;border:1px solid var(--border);border-radius:999px;background:var(--surface);text-decoration:none;color:var(--text);cursor:pointer}
  .danger{color:#b42318;border-color:#f2c6c4;background:#fff5f4}
  .card{display:flex;align-items:center;gap:12px;background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:12px;margin-bottom:10px;box-shadow:0 1px 2px rgba(0,0,0,.04);transition:background .15s,border-color .15s}
  .card.checked{background:var(--checked);border-color:#c8e7fb}
  .chk-wrap{position:relative;display:inline-flex;align-items:center;justify-content:center;width:28px;height:28px;flex:none}
  .chk{appearance:none;width:0;height:0;position:absolute;opacity:0}
  .fake{display:inline-block;width:20px;height:20px;border:2px solid var(--border);border-radius:6px;background:#fff}
  .chk:checked + .fake{border-color:var(--accent);background:var(--accent);
    background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"><path fill="white" d="M6.6 11.6L3.5 8.5l1.1-1.1 2 2 4-4 1.1 1.1z"/></svg>');
    background-repeat:no-repeat;background-position:center}
  .body{flex:1;min-width:0}
  .title{font-weight:700;white-space:normal;word-break:break-word;line-height:1.35;margin-bottom:2px}
  .meta{margin-top:4px;color:var(--muted);font-size:14px;line-height:1.5}
  .meta .line{white-space:normal;word-break:break-word}
  .meta .line.small{font-size:12px}
  .date-badge{min-width:54px;text-align:center;font-variant-numeric:tabular-nums;color:var(--muted);font-weight:700}
</style>

<header>
  <a class="back" href="index.html" onclick="return goBack(event)">戻る</a>
  <h1 style="writing-mode:horizontal-tb; text-orientation:mixed; white-space:nowrap;">調布市 巡回</h1>
  <span class="count" id="count">0/54</span>
<div style="text-align:center;font-size:12px;color:#6b7280;margin-top:-6px;margin-bottom:6px;">日付を編集→ 各行の日付ラベルをタップ</div></header>
<main>
  <div class="toolbar">
    <span class="pill" onclick="checkAll()">全てチェック</span>
    <span class="pill" onclick="uncheckAll()">全て外す</span>
    <span class="pill danger" onclick="clearAll()">リセット</span>
  </div>
  
    <div class="card" data-key="調布市:0">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布下石原第２</div>
        <div class="meta"><div class='line'>ノート</div><div class='line'>多摩502ワ7204</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:1">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布下石原第３</div>
        <div class="meta"><div class='line'>ソリオ</div><div class='line'>多摩502ワ7730</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:2">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布下石原第３</div>
        <div class="meta"><div class='line'>ヤリス</div><div class='line'>多摩502ワ5494</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:3">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布下石原第３</div>
        <div class="meta"><div class='line'>アクア</div><div class='line'>多摩503ワ1004</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:4">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">下石原２丁目第２</div>
        <div class="meta"><div class='line'>MAZDA2</div><div class='line'>多摩502ワ8969</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:5">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">下石原２丁目第２</div>
        <div class="meta"><div class='line'>ノート</div><div class='line'>多摩502ワ9171</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:6">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">下石原２丁目</div>
        <div class="meta"><div class='line'>フィット</div><div class='line'>多摩502ワ5930</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:7">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">下石原２丁目</div>
        <div class="meta"><div class='line'>スイフト</div><div class='line'>多摩502ワ9693</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:8">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布下石原第４</div>
        <div class="meta"><div class='line'>ノート</div><div class='line'>多摩502ワ7095</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:9">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布下石原第４</div>
        <div class="meta"><div class='line'>アクア</div><div class='line'>多摩503ワ598</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:10">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">フィールドコート調布</div>
        <div class="meta"><div class='line'>ヤリス</div><div class='line'>多摩503ワ918</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:11">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布小島町第２</div>
        <div class="meta"><div class='line'>ソリオ</div><div class='line'>多摩502ワ7447</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:12">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布小島町第２</div>
        <div class="meta"><div class='line'>ヤリス</div><div class='line'>多摩502ワ5514</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:13">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布小島町第２</div>
        <div class="meta"><div class='line'>ヤリスクロス</div><div class='line'>多摩300ワ7433</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:14">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布小島町第２</div>
        <div class="meta"><div class='line'>ヤリスクロス</div><div class='line'>多摩300ワ9657</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:15">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布小島町第２</div>
        <div class="meta"><div class='line'>アクア</div><div class='line'>多摩502ワ9391</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:16">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布小島町第２</div>
        <div class="meta"><div class='line'>アクア</div><div class='line'>多摩503ワ1006</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:17">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布小島町第２</div>
        <div class="meta"><div class='line'>シエンタ</div><div class='line'>多摩502ワ8357</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:18">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布小島町第２</div>
        <div class="meta"><div class='line'>スイフト</div><div class='line'>多摩503ワ19</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:19">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布小島町第２（ＥＶ）</div>
        <div class="meta"><div class='line'>サクラ</div><div class='line'>多摩580ワ5206</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:20">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">調布ルピナス駐車場</div>
        <div class="meta"><div class='line'>N BOX</div><div class='line'>多摩580ワ4533</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:21">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">シスコンパーク調布小島町第１</div>
        <div class="meta"><div class='line'>ライズ</div><div class='line'>多摩502ワ5454</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:22">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">シスコンパーク調布小島町第１</div>
        <div class="meta"><div class='line'>MAZDA3</div><div class='line'>多摩300ワ9166</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:23">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">シスコンパーク調布小島町第１</div>
        <div class="meta"><div class='line'>MAZDA2</div><div class='line'>多摩502ワ8797</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:24">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">シスコンパーク調布小島町第１</div>
        <div class="meta"><div class='line'>MAZDA2</div><div class='line'>多摩503ワ1015</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:25">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">シスコンパーク調布小島町第１</div>
        <div class="meta"><div class='line'>オーラ</div><div class='line'>多摩300ワ8929</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:26">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">シスコンパーク調布小島町第１</div>
        <div class="meta"><div class='line'>ソリオ</div><div class='line'>多摩502ワ8821</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:27">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">シスコンパーク調布小島町第１</div>
        <div class="meta"><div class='line'>ヤリス</div><div class='line'>多摩502ワ7631</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:28">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">調布小島町２丁目</div>
        <div class="meta"><div class='line'>MAZDA2</div><div class='line'>多摩503ワ71</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:29">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">調布小島町２丁目第２</div>
        <div class="meta"><div class='line'>CX-30</div><div class='line'>多摩300ワ7854</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:30">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">調布小島町２丁目第２</div>
        <div class="meta"><div class='line'>ノア</div><div class='line'>多摩300ワ9110</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:31">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">調布小島町３丁目</div>
        <div class="meta"><div class='line'>ノート</div><div class='line'>多摩503ワ765</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:32">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">調布小島町３丁目</div>
        <div class="meta"><div class='line'>ヤリス</div><div class='line'>多摩503ワ773</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:33">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">ＵＲシティハイツ調布小島町</div>
        <div class="meta"><div class='line'>オーラ</div><div class='line'>多摩300ワ8750</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:34">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">調布上石原月極駐車場</div>
        <div class="meta"><div class='line'>ヤリス</div><div class='line'>多摩502ワ5528</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:35">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">調布上石原月極駐車場</div>
        <div class="meta"><div class='line'>ヤリス</div><div class='line'>多摩502ワ7979</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:36">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布多摩川第８</div>
        <div class="meta"><div class='line'>ルーミー</div><div class='line'>多摩502ワ8436</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:37">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布多摩川第８</div>
        <div class="meta"><div class='line'>シエンタ</div><div class='line'>多摩502ワ4138</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:38">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布多摩川第６（２）</div>
        <div class="meta"><div class='line'>アクア</div><div class='line'>多摩502ワ9632</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:39">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布多摩川第６（１）</div>
        <div class="meta"><div class='line'>ノート</div><div class='line'>多摩502ワ9831</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:40">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布多摩川第６（１）</div>
        <div class="meta"><div class='line'>ヤリス</div><div class='line'>多摩503ワ450</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:41">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布多摩川第６（１）</div>
        <div class="meta"><div class='line'>アクア</div><div class='line'>多摩503ワ582</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:42">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">多摩川月極駐車場</div>
        <div class="meta"><div class='line'>ハスラー</div><div class='line'>多摩580ワ4004</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:43">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">調布多摩川７丁目</div>
        <div class="meta"><div class='line'>ソリオ</div><div class='line'>多摩503ワ38</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:44">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">調布多摩川７丁目</div>
        <div class="meta"><div class='line'>アクア</div><div class='line'>多摩503ワ5</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:45">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ飛田給第２</div>
        <div class="meta"><div class='line'>MAZDA2</div><div class='line'>多摩502ワ6880</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:46">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ飛田給第２</div>
        <div class="meta"><div class='line'>ヤリス</div><div class='line'>多摩502ワ8007</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:47">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ飛田給第２</div>
        <div class="meta"><div class='line'>アクア</div><div class='line'>多摩502ワ8428</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:48">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ飛田給第２</div>
        <div class="meta"><div class='line'>アクア</div><div class='line'>多摩502ワ4452</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:49">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ飛田給第２</div>
        <div class="meta"><div class='line'>スイフト</div><div class='line'>多摩503ワ162</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:50">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ飛田給第２</div>
        <div class="meta"><div class='line'>プリウス</div><div class='line'>多摩300ワ8523</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:51">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ飛田給２丁目１１</div>
        <div class="meta"><div class='line'>ノート</div><div class='line'>多摩502ワ7389</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:52">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ飛田給２丁目１１</div>
        <div class="meta"><div class='line'>ヤリス</div><div class='line'>多摩502ワ8532</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
    <div class="card" data-key="調布市:53">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">飛田給３丁目</div>
        <div class="meta"><div class='line'>CX-5</div><div class='line'>多摩300ワ9253</div><div class='line small'>nan</div></div>
      </div>
      <div class="date-badge"></div>
    </div>
    
</main>

<script>
function goBack(e){ e.preventDefault(); location.href="index.html"; return false; }
function mmdd(){
  const d=new Date(); const m=('0'+(d.getMonth()+1)).slice(-2); const day=('0'+d.getDate()).slice(-2); return m+'-'+day;
}
function key(city, idx){ return 'chk:'+city+':'+idx; }
function loadCardState(city, idx){
  try{ return JSON.parse(localStorage.getItem(key(city, idx))) || null; }catch(e){ return null; }
}
function saveCardState(city, idx, checked){
  const v = checked ? {checked:true, date:mmdd()} : {checked:false, date:''};
  localStorage.setItem(key(city, idx), JSON.stringify(v));
}
function applyToCard(card, state){
  const cb = card.querySelector('.chk');
  const dateEl = card.querySelector('.date-badge');
  if(state && state.checked){
    cb.checked = true;
    card.classList.add('checked');
    dateEl.textContent = state.date || mmdd();
  }else{
    cb.checked = false;
    card.classList.remove('checked');
    dateEl.textContent = '';
  }
}
function confirmToggle(){ return confirm('よろしいですか？'); }
function updateCount(city){
  const cards = Array.from(document.querySelectorAll('.card'));
  const total = cards.length;
  const done = cards.filter(c=>c.classList.contains('checked')).length;
  document.getElementById('count').textContent = done + "/" + total;
}
function attachHandlers(city){
  document.querySelectorAll('.card').forEach((card,idx)=>{
    const st = loadCardState(city, idx);
    applyToCard(card, st);
    const cb = card.querySelector('.chk');
    cb.addEventListener('change', e=>{
      if(!confirmToggle()){ e.target.checked = !e.target.checked; return; }
      const checked = e.target.checked;
      saveCardState(city, idx, checked);
      applyToCard(card, loadCardState(city, idx));
      updateCount(city);
    });
  });
  updateCount(city);
  const cards = Array.from(document.querySelectorAll('.card'));
  window.checkAll = ()=>{
    if(!confirmToggle()) return;
    cards.forEach((card,idx)=>{ saveCardState(city, idx, true); applyToCard(card, loadCardState(city, idx)); });
    updateCount(city);
  };
  window.uncheckAll = ()=>{
    if(!confirmToggle()) return;
    cards.forEach((card,idx)=>{ saveCardState(city, idx, false); applyToCard(card, loadCardState(city, idx)); });
    updateCount(city);
  };
  window.clearAll = ()=>{
    if(!confirmToggle()) return;
    cards.forEach((card,idx)=>{ localStorage.removeItem(key(city, idx)); applyToCard(card, null); });
    updateCount(city);
  };
}
</script>

<script>document.addEventListener('DOMContentLoaded', ()=> attachHandlers('調布市'));</script>

<script>
(function(){
  var CITY = '';
  function getCity(){
    var t = (document.querySelector('header h1')?.textContent || '').trim();
    return t.replace(' 巡回','');
  }
  function countAndRender(){
    var cards = Array.from(document.querySelectorAll('.card'));
    var total = cards.length;
    var checked = cards.filter(function(c){
      var cb = c.querySelector('.chk');
      return (c.classList.contains('checked')) || (cb && cb.checked);
    }).length;
    var el = document.getElementById('count');
    if(el){ el.textContent = checked + '/' + total; }
    try{ localStorage.setItem('巡回:stats:' + CITY, JSON.stringify({checked:checked,total:total,updatedAt:new Date().toISOString()})); }catch(e){}
    try{ if(typeof updateCount === 'function') updateCount(CITY); }catch(e){}
  }
  function keyOf(card){
    return card.getAttribute('data-key') || '';
  }
  function markDeleted(card){
    var k = keyOf(card);
    if(!k) return;
    try{
      localStorage.setItem('del:' + k, '1');
      localStorage.removeItem('chk:' + k);
      var i = k.indexOf(':');
      if(i>-1){
        var CITYNAME = k.slice(0,i);
        var idx = k.slice(i+1);
        localStorage.removeItem('chk:' + CITYNAME + ':' + idx);
      }
    }catch(e){}
  }
  function applyInitialDeletions(){
    document.querySelectorAll('.card').forEach(function(card){
      var k = keyOf(card);
      try{
        if(localStorage.getItem('del:' + k) === '1'){
          card.remove();
        }
      }catch(e){}
    });
  }
  function ensureDeleteButtons(){
    document.querySelectorAll('.card').forEach(function(card){
      var btn = card.querySelector('.delete-btn');
      if(!btn){
        btn = document.createElement('button');
        btn.type = 'button';
        btn.textContent = '削除';
        btn.className = 'delete-btn';
        btn.style.cssText = 'margin-left:auto;padding:8px 10px;font-size:12px;border:1px solid #e6e8ee;border-radius:8px;background:#fff;';
        card.appendChild(btn);
      }
      if(!btn._wired){
        btn.addEventListener('click', function(){
          if(!confirm('削除してよろしいですか？')) return;
          markDeleted(card);
          card.remove();
          countAndRender();
        });
        btn._wired = true;
      }
    });
  }
  function attachCountSync(){
    document.addEventListener('change', function(e){
      if(e.target && e.target.classList && e.target.classList.contains('chk')){
        setTimeout(countAndRender, 0);
      }
    });
  }
  document.addEventListener('DOMContentLoaded', function(){
    CITY = getCity();
    applyInitialDeletions();
    ensureDeleteButtons();
    attachCountSync();
    countAndRender();
  });
})();
</script>


<style>
  .toolbar{display:none !important;}
  .idx-badge{
    width: 28px; min-width:28px;
    text-align: center;
    font-variant-numeric: tabular-nums;
    color: #6b7280;
    font-weight: 700;
    user-select: none;
  }
  .card .chk-wrap{ margin-left: 0; }
  .date-badge{ line-height: 1.05; display:inline-block; text-align:center; white-space:normal; }
  .db-mmdd{ font-weight:700; }
  .db-hm{ font-size: 12px; opacity: .8; }
</style>
<script>
// ---- auto-log patch v16 (doc-level capture click; iOS-safe confirm->toggle) ----
(function(){
  if(window.__autoLogPatchedV16) return; window.__autoLogPatchedV16 = true;
  var ENDPOINT="https://script.google.com/macros/s/AKfycbzjsPGgz2LRNs5uRcwql6B4bqafRR1JkwMfPQiyyShwyQZzmVGiWbTUuWhJV_q4g-kfpA/exec", SECRET="rkw123";
  window.checkAll=function(){}; window.uncheckAll=function(){}; window.clearAll=function(){};

  // Remove header help text containing "日付を編集"
  var header = document.querySelector('header');
  if(header){
    Array.prototype.slice.call(header.querySelectorAll('*')).forEach(function(n){
      var t = (n.textContent||'').replace(/\s+/g,'');
      if(t.indexOf('日付を編集') !== -1){ n.remove(); }
    });
  }

  var _q=[], _busy=false;
  function enqueue(p){ _q.push(p); if(!_busy) pump(); }
  async function pump(){ _busy=true; while(_q.length){ var body=JSON.stringify(Object.assign({secret:SECRET}, _q.shift())); try{ await fetch(ENDPOINT,{method:'POST',headers:{'Content-Type':'text/plain'},body}); }catch(e){} await new Promise(r=>setTimeout(r,120)); } _busy=false; }

  function nowJST(){
    var d = new Date();
    function pad(n){ return ('0'+n).slice(-2); }
    return d.getFullYear() + '/' + pad(d.getMonth()+1) + '/' + pad(d.getDate()) + ' ' + pad(d.getHours()) + ':' + pad(d.getMinutes());
  }
  function partsNow(){
    var d = new Date();
    function pad(n){ return ('0'+n).slice(-2); }
    return { mmdd: pad(d.getMonth()+1)+'/'+pad(d.getDate()), hm: pad(d.getHours())+':'+pad(d.getMinutes()) };
  }
  function badgeHTML(mmdd,hm){ return '<div class="db-mmdd">'+mmdd+'</div><div class="db-hm">'+hm+'</div>'; }

  function text(el, sel){ var t = el && el.querySelector(sel); return t ? (t.textContent||'').trim() : ''; }
  function metaLines(card){ return Array.prototype.map.call(card.querySelectorAll('.meta .line'), function(x){return (x.textContent||'').trim();}); }
  function fallbackFields(card){
    var station = text(card,'.title');
    var lines = metaLines(card);
    var model = lines.length ? lines[0] : '';
    var plate = lines.length>1 ? lines[1] : '';
    return {station_name:station, vehicle_model:model, plate_number:plate};
  }
  function pickAttr(card, name, fb){ var v = card.getAttribute(name); return (v && v.trim()) ? v.trim() : (fb || ''); }

  function setup(){
    var H1=document.querySelector('h1'); var CITY=(H1&&H1.textContent)?H1.textContent.replace(' 巡回','').trim():'';
    var cards=[].slice.call(document.querySelectorAll('.card')); var countEl=document.getElementById('count');
    function key(i){return 'chk:'+CITY+':'+i;} 
    function save(i,c,d){try{localStorage.setItem(key(i),JSON.stringify({checked:c,date:d}))}catch(e){}}
    function load(i){try{return JSON.parse(localStorage.getItem(key(i)))||null}catch(e){return null}}
    function updateCount(){
      var c=cards.filter(c=>c.classList.contains('checked')).length;
      if(countEl) countEl.textContent = c + '/' + cards.length;
      try{localStorage.setItem('巡回:stats:'+CITY,JSON.stringify({checked:c,total:cards.length}))}catch(e){}
    }

    function applyToggle(card, chk, badge, i, station_name, vehicle_model, plate_number, makeChecked){
      var p = partsNow();
      if(makeChecked){
        card.classList.add('checked'); chk.checked = true;
        if(badge) badge.innerHTML = badgeHTML(p.mmdd, p.hm);
        save(i,true, p.mmdd + '\\n' + p.hm);
        enqueue({
          ts: nowJST(), city: CITY, index: i+1,
          station_name: station_name,
          vehicle_model: vehicle_model,
          plate_number: plate_number,
          date_badge: p.mmdd, checked: true
        });
      } else {
        card.classList.remove('checked'); chk.checked = false;
        if(badge) badge.textContent='';
        save(i,false,'');
        enqueue({ city: CITY, plate_number: plate_number, delete: true });
      }
      updateCount();
    }

    cards.forEach(function(card,i){
      if(card.__patchedV16) return; card.__patchedV16=true;
      var chk=card.querySelector('.chk'); var badge=card.querySelector('.date-badge'); var data=load(i);

      // index badge (1-start)
      if(!card.querySelector('.idx-badge')){
        var idxSpan = document.createElement('span');
        idxSpan.className = 'idx-badge';
        idxSpan.textContent = String(i+1);
        if(card.firstElementChild){ card.insertBefore(idxSpan, card.firstElementChild); } else { card.prepend(idxSpan); }
      }

      // 復元
      if(data && data.checked){
        card.classList.add('checked'); if(chk) chk.checked=true;
        if(badge){
          if((data.date||'').indexOf('\\n')>=0){
            var sp = data.date.split('\\n');
            badge.innerHTML = badgeHTML(sp[0], sp[1]||'');
          }else{
            badge.textContent = data.date||'';
          }
        }
      }
      if(!chk) return;

      var fb = fallbackFields(card);
      var station_name = pickAttr(card,'data-station', fb.station_name);
      var vehicle_model = pickAttr(card,'data-model',   fb.vehicle_model);
      var plate_number  = pickAttr(card,'data-plate',   fb.plate_number);

      // Document-level capture: handle taps on checkbox or its label/container
      function isChkOrLabel(t){
        if(!t) return null;
        if(t === chk) return chk;
        if(t.matches && (t.matches('label') || t.matches('.chk-wrap'))) return chk;
        var lb = t.closest && t.closest('label,.chk-wrap');
        if(lb) return chk;
        return null;
      }

      document.addEventListener('click', function(ev){
        var target = ev.target;
        var hit = isChkOrLabel(target);
        if(!hit) return;
        if(!card.contains(target)) return; // only this card

        ev.stopImmediatePropagation();
        ev.preventDefault();

        var next = !chk.checked;
        if(!confirm('よろしいですか？')) return;
        // iOS safeness: defer state change after confirm
        setTimeout(function(){
          applyToggle(card, chk, badge, i, station_name, vehicle_model, plate_number, next);
        },0);
      }, true);

      // Keyboard support on checkbox
      chk.addEventListener('keydown', function(ev){
        if(ev.key === ' ' || ev.key === 'Enter'){
          ev.stopImmediatePropagation();
          ev.preventDefault();
          var next = !chk.checked;
          if(!confirm('よろしいですか？')) return;
          setTimeout(function(){
            applyToggle(card, chk, badge, i, station_name, vehicle_model, plate_number, next);
          },0);
        }
      }, true);

      // 既存の削除ボタン（クラス/属性のばらつきに配慮）
      var delBtn = card.querySelector('.del-btn, [data-role="delete"]');
      if(delBtn && !delBtn.__patchedV16){
        delBtn.__patchedV16 = true;
        delBtn.addEventListener('click', function(){
          if(!confirm('この項目を未チェックに戻してログも削除します。よろしいですか？')) return;
          applyToggle(card, chk, badge, i, station_name, vehicle_model, plate_number, false);
        });
      }
    });
    updateCount();
  }

  if(document.readyState==='complete'||document.readyState==='interactive'){ setTimeout(setup,0); }
  else { document.addEventListener('DOMContentLoaded', setup); }
})();
</script>
</html>
