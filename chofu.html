<!doctype html>
<html lang="ja">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>調布市 巡回</title>
<script>var ENDPOINT="https://script.google.com/macros/s/AKfycbzjsPGgz2LRNs5uRcwql6B4bqafRR1JkwMfPQiyyShwyQZzmVGiWbTUuWhJV_q4g-kfpA/exec";var SECRET="rkw123";</script>
<style>
  :root{ --bg:#f6f7fb; --surface:#fff; --border:#e6e8ee; --text:#111; --muted:#6b7280; --accent:#111; --checked:#ffe8ef; }
  *{box-sizing:border-box}
  html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
  header{position:sticky;top:0;background:var(--surface);padding:10px 12px;border-bottom:1px solid var(--border);z-index:10;display:flex;gap:8px;align-items:center}
  header .back{text-decoration:none;border:1px solid var(--border);padding:8px 12px;border-radius:12px;color:var(--text)}
  header h1{margin:0;font-size:18px;flex:1;text-align:center;letter-spacing:.03em}
  header .count{font-weight:700;color:var(--muted);font-variant-numeric:tabular-nums}
  main{padding:12px 12px 24px;max-width:820px;margin:0 auto}
  .card{display:flex;align-items:center;gap:12px;background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:12px;margin-bottom:10px;box-shadow:0 1px 2px rgba(0,0,0,.04);transition:background .15s,border-color .15s}
  .card.checked{background:var(--checked);border-color:#f8c9d7}
  .chk-wrap{position:relative;display:inline-flex;align-items:center;justify-content:center;width:28px;height:28px;flex:none}
  .chk{appearance:none;width:0;height:0;position:absolute;opacity:0}
  .fake{display:inline-block;width:20px;height:20px;border:2px solid var(--border);border-radius:6px;background:#fff}
  .chk:checked + .fake{border-color:var(--accent);background:var(--accent);
    background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"><path fill="white" d="M6.6 11.6L3.5 8.5l1.1-1.1 2 2 4-4 1.1 1.1z"/></svg>');
    background-repeat:no-repeat;background-position:center}
  .body{flex:1;min-width:0}
  .title{font-weight:700;white-space:normal;word-break:break-word;line-height:1.35;margin-bottom:2px}
  .meta{margin-top:4px;color:var(--muted);font-size:14px;line-height:1.5}
  .meta .line{white-space:normal;word-break:break-word}
  .meta .line.small{font-size:12px}
  .date-badge{min-width:54px;text-align:center;font-variant-numeric:tabular-nums;color:var(--muted);font-weight:700}
</style>
<header>
  <a class="back" href="index.html" onclick="return goBack(event)">戻る</a>
  <h1>調布市 巡回</h1>
  <span class="count" id="count">0</span>
</header>
<main>
<div class="card" data-key="調布市:0">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布下石原第２</div>
<div class="card" data-key="調布市:1">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布下石原第３</div>
<div class="card" data-key="調布市:2">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布下石原第３</div>
<div class="card" data-key="調布市:3">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布下石原第３</div>
<div class="card" data-key="調布市:4">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">下石原２丁目第２</div>
<div class="card" data-key="調布市:5">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">下石原２丁目第２</div>
<div class="card" data-key="調布市:6">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">下石原２丁目</div>
<div class="card" data-key="調布市:7">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">下石原２丁目</div>
<div class="card" data-key="調布市:8">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布下石原第４</div>
<div class="card" data-key="調布市:9">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布下石原第４</div>
<div class="card" data-key="調布市:10">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">フィールドコート調布</div>
<div class="card" data-key="調布市:11">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布小島町第２</div>
<div class="card" data-key="調布市:12">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布小島町第２</div>
<div class="card" data-key="調布市:13">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布小島町第２</div>
<div class="card" data-key="調布市:14">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布小島町第２</div>
<div class="card" data-key="調布市:15">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布小島町第２</div>
<div class="card" data-key="調布市:16">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布小島町第２</div>
<div class="card" data-key="調布市:17">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布小島町第２</div>
<div class="card" data-key="調布市:18">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布小島町第２</div>
<div class="card" data-key="調布市:19">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布小島町第２（ＥＶ）</div>
<div class="card" data-key="調布市:20">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">調布ルピナス駐車場</div>
<div class="card" data-key="調布市:21">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">シスコンパーク調布小島町第１</div>
<div class="card" data-key="調布市:22">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">シスコンパーク調布小島町第１</div>
<div class="card" data-key="調布市:23">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">シスコンパーク調布小島町第１</div>
<div class="card" data-key="調布市:24">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">シスコンパーク調布小島町第１</div>
<div class="card" data-key="調布市:25">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">シスコンパーク調布小島町第１</div>
<div class="card" data-key="調布市:26">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">シスコンパーク調布小島町第１</div>
<div class="card" data-key="調布市:27">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">シスコンパーク調布小島町第１</div>
<div class="card" data-key="調布市:28">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">調布小島町２丁目</div>
<div class="card" data-key="調布市:29">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">調布小島町２丁目第２</div>
<div class="card" data-key="調布市:30">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">調布小島町２丁目第２</div>
<div class="card" data-key="調布市:31">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">調布小島町３丁目</div>
<div class="card" data-key="調布市:32">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">調布小島町３丁目</div>
<div class="card" data-key="調布市:33">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">ＵＲシティハイツ調布小島町</div>
<div class="card" data-key="調布市:34">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">調布上石原月極駐車場</div>
<div class="card" data-key="調布市:35">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">調布上石原月極駐車場</div>
<div class="card" data-key="調布市:36">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布多摩川第８</div>
<div class="card" data-key="調布市:37">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布多摩川第８</div>
<div class="card" data-key="調布市:38">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布多摩川第６（２）</div>
<div class="card" data-key="調布市:39">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布多摩川第６（１）</div>
<div class="card" data-key="調布市:40">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布多摩川第６（１）</div>
<div class="card" data-key="調布市:41">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ調布多摩川第６（１）</div>
<div class="card" data-key="調布市:42">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">多摩川月極駐車場</div>
<div class="card" data-key="調布市:43">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">調布多摩川７丁目</div>
<div class="card" data-key="調布市:44">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">調布多摩川７丁目</div>
<div class="card" data-key="調布市:45">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ飛田給第２</div>
<div class="card" data-key="調布市:46">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ飛田給第２</div>
<div class="card" data-key="調布市:47">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ飛田給第２</div>
<div class="card" data-key="調布市:48">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ飛田給第２</div>
<div class="card" data-key="調布市:49">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ飛田給第２</div>
<div class="card" data-key="調布市:50">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ飛田給第２</div>
<div class="card" data-key="調布市:51">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ飛田給２丁目１１</div>
<div class="card" data-key="調布市:52">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">タイムズ飛田給２丁目１１</div>
<div class="card" data-key="調布市:53">
      <label class="chk-wrap">
        <input type="checkbox" class="chk">
        <span class="fake"></span>
      </label>
      <div class="body">
        <div class="title">飛田給３丁目</div>
</main>
<script>
(function(){
  var CITY="調布市";
  var cards=[].slice.call(document.querySelectorAll('.card'));
  var countEl=document.getElementById('count');
  function keyFor(i){return 'chk:'+CITY+':'+i;} 
  function save(i,c,d){localStorage.setItem(keyFor(i),JSON.stringify({checked:c,date:d}));}
  function load(i){try{return JSON.parse(localStorage.getItem(keyFor(i)))||null}catch(e){return null}}
  function fmtDate(d){var m=('0'+(d.getMonth()+1)).slice(-2),day=('0'+d.getDate()).slice(-2);return m+'-'+day;}
  function nowISO(){return new Date().toISOString();}
  function updateCount(){var c=cards.filter(c=>c.classList.contains('checked')).length;if(countEl)countEl.textContent=c;try{localStorage.setItem('巡回:stats:'+CITY,JSON.stringify({checked:c,total:cards.length}))}catch(e){}}
  function post(p){try{fetch(ENDPOINT,{method:'POST',headers:{'Content-Type':'text/plain'},body:JSON.stringify(Object.assign({secret:SECRET},p))})}catch(e){}}
  function onPayload(card,i,ds){return{ts:nowISO(),city:CITY,index:i,station_name:card.getAttribute('data-station')||'',vehicle_model:card.getAttribute('data-model')||'',plate_number:card.getAttribute('data-plate')||'',date_badge:ds||'',checked:true}}
  function offPayload(card){return{city:CITY,plate_number:card.getAttribute('data-plate')||'',delete:true}}
  cards.forEach(function(card,i){var chk=card.querySelector('.chk');var badge=card.querySelector('.date-badge');var data=load(i);
    if(data&&data.checked){card.classList.add('checked');if(badge)badge.textContent=data.date||'';chk.checked=true;}
    chk.addEventListener('change',function(){var ds=fmtDate(new Date());if(chk.checked){card.classList.add('checked');if(badge)badge.textContent=ds;save(i,true,ds);post(onPayload(card,i,ds));}else{card.classList.remove('checked');if(badge)badge.textContent='';save(i,false,'');post(offPayload(card));}updateCount();});
    if(badge){badge.addEventListener('click',function(){var input=prompt('MM-DD で入力（例: 08-27）',badge.textContent||fmtDate(new Date()));if(input){var isChecked=card.classList.contains('checked');badge.textContent=input;save(i,isChecked,input);if(isChecked)post(onPayload(card,i,input));}});}
  });
  updateCount();
  window.goBack=function(e){e.preventDefault();location.href='index.html';return false;}
})();
</script>
</html>